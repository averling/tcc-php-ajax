

<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>

	<section id="segura-items">
		<h3>Escoramento de Laje</h3>
		<form  name="form" action="" method="POST"> 

			<!-- Informações sobre a estrutura e peso da laje-->
			<fieldset>	
				<legend>Dados da Estrutura</legend>
					<p> Digite a espessura da laje em metros (m):</p>	
					<input type="text" name="espessura" id="espessura" placeholder="espessura (m)" required/>
					<input type="button" value="Calcular" id="CalcularLaje">
					<p>Peso da laje pelo momento em tf/m: </p>
					<input type="text" name="peso_lj_momento" id="peso_lj_momento" placeholder="peso pelo momento" value = "0" readonly="" /> tf/m
					<p>Peso da laje pela flecha em tf/m: </p> 
					<input type="text" name="peso_lj_flecha" id="peso_lj_flecha" placeholder="peso pela flecha" value = "0" readonly="" /> tf/m
			</fieldset>
			

			<!-- Informações sobre o compensado-->
			<fieldset>
				<legend>Dados do compensado</legend>
					<p>Escolha o compensado:</p>
					<select id="compensado">
						<option value="0">Selecione um item</option>
						<?php
							for($i = 0; $i < count($compensado['id']); $i++){
						?>
							<option value="<?php echo $compensado['id'][$i]; ?>"><?php echo $compensado['esp_comp'][$i]; ?></option>
						<?php
							}
						?>

					</select>  
					<br>
					<p>Escolha o tipo do compensado</p>
					<select id="tipo_comp">
						<option value="0">Selecione um item</option>
						<?php 
							for($i = 0; $i < count($chapas['id']); $i++){
						?>
							<option value="<?php echo $chapas['id'][$i]; ?>"><?php echo $chapas['tipo_chapa'][$i]; ?></option>
						<?php
							}
						?>

					</select> 
					<br>
					<br>
					<input type="button" value="Calcular" id="CalcularAdmCompensado">
					<br>
					<p>Vão máximo admissivel pelo compensado:	</p>	
					<input type="text" name="Lcomp" id="Lcomp" placeholder="vão máximo do compensado" readonly="" /> cm
					<br>
					<p>Vão máximo atuante pelo compensado:	</p>	
					<input type="text" name="Lcomp_atuante" id="Lcomp_atuante" placeholder="vão máximo atuante do compensado" /> cm
											
			</fieldset>
			

			<!-- Informações sobre o perfil secundario-->
			<fieldset>
				<legend>Dados do perfil secundario</legend>
					<p>Escolha o perfil secundario:</p>
					<select id="perfil_secundario"> 
					<option value="0">Selecione um item</option>
						<?php
							for($i = 0; $i < count($perfil['id']); $i++){
						?>
							<option value="<?php echo $perfil['id'][$i]; ?>"><?php echo $perfil['nome_perfil'][$i]; ?></option>
						<?php
							}
						?>   
					</select>
					<br>
					<br>
					<input type="button" value="Calcular Vao do Perfil" id="CalcularPerfilSecundario">
					<p> Vão máximo admissivel pelo perfil secundario:</p>	
					<input type="text" name="Lperfilsecundario" id="Lperfilsecundario" placeholder="vão máximo do perfil secundario" readonly="" /> m
					<br>
					<p> Vão máximo atuante pelo perfil secundario:</p>	
					<input type="text" name="Lperfilsec_atuante" id="Lperfilsec_atuante" placeholder="vão máximo atuante do perfil secundario"  /> m
			</fieldset>


			<!-- Informações sobre o perfil primario-->
			<fieldset>
				<legend>Dados do perfil primario</legend>
					<p>Escolha o perfil primario:</p>
					<select id="perfil_primario">
					<option value="0">Selecione um item</option>
						<?php
							for($i = 0; $i < count($perfil['id']); $i++){
						?>
							<option value="<?php echo $perfil['id'][$i]; ?>"><?php echo $perfil['nome_perfil'][$i]; ?></option>
						<?php
							}
						?>     
					</select>	
					<br>
					<br>
					<input type="button" value="Calcular Vao do Perfil" id="CalcularPerfilPrimario">

					<p> Vão máximo admissivel pelo perfil primario:</p>	
					<input type="text" name="Lperfilprimario" id="Lperfilprimario" placeholder="vão máximo do perfil primario" readonly="" /> m
					<p> Vão máximo atuante pelo perfil primario:</p>	
					<input type="text" name="Lperfilpri_atuante" id="Lperfilpri_atuante" placeholder="vão máximo atuante do perfil primario" /> m
					
			</fieldset>

		<!-- Informações sobre carga no poste-->
						<fieldset>
				<legend>Carga no poste</legend>
					<p> área de influencia pelo espaçamento máximo dos perfis:</p>	
					<input type="text" name="area" id="area_influencia" placeholder="area de influencia"  /> m²
					<br>
					<br>
					
					<input type ='button' name="carga_no_poste" id= "carga_no_poste" value= 'Calcula carga no poste'> 
					
					<p> Carga no poste:</p>	
					<input type="text" name="carga_poste" id="carga_poste" placeholder="carga no poste" readonly="" />	tf
					<br>
					<br>
					<button type="submit" name="salvarCalculo" title="Salva novo Calculo">Salvar</button> 
			</fieldset>

		</form>
	</section>

<!-- Scripts -->

<script src="jquery-1.12.4.js"></script>
<script>
	$('#CalcularLaje').click(function(){
		var espessura = $('#espessura').val();
		$.ajax({
			url: 'calcular.php?action=PesoDeLaje',
			type: 'POST',
			data: {
				'Espessura': espessura
			},
			success:function(data){
				console.log(data);
				if(data.Erro != null){
					alert(data.Erro);
				}else{
					$('#peso_lj_momento').val(data.Momento.toFixed(3));
					$('#peso_lj_flecha').val(data.Flecha.toFixed(3));
				}
			}
		});
	});

	$('#CalcularAdmCompensado').click(function(){
		var espessura = $('#espessura').val();
		var tipo_comp = $('#tipo_comp option:selected').val();
		var compensado = $('#compensado option:selected').val();

		$.ajax({
			url: 'calcular.php?action=CalcularVao',
			type: 'POST',
			data: {
				'ID_compensado': compensado,
				'Espessura': espessura,
				'tipo_comp': tipo_comp
			},
			success:function(data){
				console.log(data);
				if(data.Erro != null){
					alert(data.Erro);
				}else{
					$('#Lcomp').val((data.Vao*100).toFixed(2));
				}
			}
		});
	});

	$('#CalcularPerfilSecundario').click(function(){
		var espessura = $('#espessura').val();
		var perfil = $('#perfil_secundario option:selected').val();
		var vao_atuante = $('#Lcomp_atuante').val();
		var vao_admissivel = $('#Lcomp').val();
		var compensado = $('#compensado option:selected').val();

		$.ajax({
			url: 'calcular.php?action=CalcularVaoPerfilSecundario',
			type: 'POST',
			data: {
				'ID_perfil': perfil,
				'Espessura': espessura,
				'vao_atuante': vao_atuante,
				'vao_admissivel':vao_admissivel,
				'Id_compensado': compensado
			},
			success:function(data){
				console.log(data);
				if(data.Erro != null){
					alert(data.Erro);
				}else{
					$('#Lperfilsecundario').val(data.VaoMaximoAdmissivel.toFixed(2));
				}
			}
		});
	});


	$('#CalcularPerfilPrimario').click(function(){
		var espessura = $('#espessura').val();
		var perfil_primario = $('#perfil_primario option:selected').val();
		var perfil_secundario = $('#perfil_secundario option:selected').val();
		var vao_atuante = $('#Lperfilsec_atuante').val();
		var vao_admissivel = $('#Lperfilsecundario').val();
		var compensado = $('#compensado option:selected').val();

		$.ajax({
			url: 'calcular.php?action=CalcularVaoPerfilPrimario',
			type: 'POST',
			data: {
				'ID_perfil_primario': perfil_primario,
				'ID_perfil_secundario' : perfil_secundario,
				'Espessura': espessura,
				'vao_atuante': vao_atuante,
				'vao_admissivel':vao_admissivel,
				'Id_compensado': compensado
			},
			success:function(data){
				console.log(data);
				if(data.Erro != null){
					alert(data.Erro);
				}else{
					$('#Lperfilprimario').val(data.VaoMaximoAdmissivel.toFixed(2));
				}
			}
		});
	});


	$('#carga_no_poste').click(function(){
		var espessura = $('#espessura').val();
		var perfil_primario = $('#perfil_primario option:selected').val();
		var perfil_secundario = $('#perfil_secundario option:selected').val();
		var vao_primario = $('#Lperfilpri_atuante').val();
		var vao_secundario = $('#Lperfilsec_atuante').val();
		var compensado = $('#compensado option:selected').val();
		//var area = $('#area').val();

		$.ajax({
			url: 'calcular.php?action=CalcularCargaPoste',
			type: 'POST',
			data: {
				'ID_perfil_primario': perfil_primario,
				'ID_perfil_secundario' : perfil_secundario,
				'Espessura': espessura,
				'vao_primario': vao_primario,
				'vao_secundario':vao_secundario,
				'Id_compensado': compensado,
				//'area':area
			},
			success:function(data){
				console.log(data);
				if(data.Erro != null){
					alert(data.Erro);
				}else{
					
					$('#carga_poste').val(data.peso.toFixed(2));
					$('#area_influencia').val(data.area_influencia.toFixed(2));
				}
			}
		});
	});

	
</script>